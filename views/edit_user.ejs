<%- include('./template/header.ejs') %>

    <div class="min-h-screen bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 py-12 px-4 animate-gradient-x">
        <div class="max-w-3xl mx-auto bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl p-6 sm:p-8">

            <!-- Heading with gradient text -->
            <h2
                class="text-3xl sm:text-4xl font-extrabold text-center mb-8 text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 flex items-center justify-center gap-2">
                ‚úèÔ∏è Edit User
            </h2>

            <form action="/user/edit/<%= user._id %>" method="POST" class="space-y-4">
                <% if (typeof errors !=='undefined' && errors.length> 0) { %>
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                        <ul class="list-disc list-inside">
                            <% errors.forEach(err=> { %>
                                <li>
                                    <%= err %>
                                </li>
                                <% }) %>
                        </ul>
                    </div>
                    <% } %>


                        <!-- User Info -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-1 text-sm">Name</label>
                                <input type="text" name="name" value="<%= user.name %>" required
                                    class="w-full border border-gray-300 rounded-2xl p-2 text-sm focus:ring-2 focus:ring-indigo-400 focus:outline-none transition shadow-sm hover:shadow-md" />
                            </div>

                            <div>
                                <label class="block text-gray-700 font-semibold mb-1 text-sm">Username</label>
                                <input type="text" name="username" value="<%= user.username %>" required
                                    class="w-full border border-gray-300 rounded-2xl p-2 text-sm focus:ring-2 focus:ring-indigo-400 focus:outline-none transition shadow-sm hover:shadow-md" />
                            </div>
                        </div>

                        <!-- Password -->
                        <div>
                            <label class="block text-gray-700 font-semibold mb-1 text-sm">Password</label>
                            <input type="text" name="password" value="<%= user.password %>"
                                class="w-full border border-gray-300 rounded-2xl p-2 text-sm focus:ring-2 focus:ring-indigo-400 focus:outline-none transition shadow-sm hover:shadow-md" />
                        </div>

                        <!-- Contact Info -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-1 text-sm">Email</label>
                                <input type="email" name="email" value="<%= user.email %>" required
                                    class="w-full border border-gray-300 rounded-2xl p-2 text-sm focus:ring-2 focus:ring-indigo-400 focus:outline-none transition shadow-sm hover:shadow-md" />
                            </div>

                            <div>
                                <label class="block text-gray-700 font-semibold mb-1 text-sm">Phone</label>
                                <input type="text" name="phone" value="<%= user.phone %>"
                                    class="w-full border border-gray-300 rounded-2xl p-2 text-sm focus:ring-2 focus:ring-indigo-400 focus:outline-none transition shadow-sm hover:shadow-md" />
                            </div>
                        </div>

                        <!-- Location -->
                        <div>
                            <label class="block text-gray-700 font-semibold mb-1 text-sm">City</label>
                            <input type="text" name="city" value="<%= user.city %>"
                                class="w-full border border-gray-300 rounded-2xl p-2 text-sm focus:ring-2 focus:ring-indigo-400 focus:outline-none transition shadow-sm hover:shadow-md" />
                        </div>

                        <!-- Description -->
                        <div>
                            <label class="block text-gray-700 font-semibold mb-1 text-sm">Description</label>
                            <textarea name="description" rows="3"
                                class="w-full border border-gray-300 rounded-2xl p-2 text-sm focus:ring-2 focus:ring-indigo-400 focus:outline-none transition shadow-sm hover:shadow-md resize-none"><%= user.description %></textarea>
                        </div>

                        <!-- Groups Section -->
                        <div class="border-t pt-4 mt-4">
                            <h3 class="text-md font-bold text-indigo-700 mb-3 flex items-center gap-2">üë• User Groups
                            </h3>
                            <div id="groups-container" class="space-y-2">
                                <% if (user.groups && user.groups.length> 0) { %>
                                    <% user.groups.forEach((group, index)=> { %>
                                        <div
                                            class="flex flex-col sm:flex-row items-center gap-2 bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-2 hover:shadow-md transition">
                                            <input type="text" name="groupNames" value="<%= group.name %>"
                                                placeholder="Group Name"
                                                class="flex-1 border border-gray-300 rounded-lg p-1 text-sm focus:ring-2 focus:ring-indigo-300 w-full sm:w-auto transition" />
                                            <button type="button" onclick="removeGroup(this)"
                                                class="bg-red-500 text-white px-3 py-1 rounded-full hover:bg-red-600 shadow-sm transition w-full sm:w-auto text-sm">üóë
                                                Remove</button>
                                        </div>
                                        <% }) %>
                                            <% } else { %>
                                                <p class="text-gray-500 text-xs italic">No groups found for this user.
                                                </p>
                                                <% } %>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="text-center mt-6">
                            <button type="submit"
                                class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-8 py-2 rounded-full font-semibold hover:from-indigo-700 hover:to-purple-700 shadow-md transform hover:scale-105 transition text-sm">
                                üíæ Save Changes
                            </button>
                        </div>
            </form>
        </div>
    </div>

    <script>
        function removeGroup(button) {
            button.parentElement.remove();
        }
    </script>

    <style>
        /* Smooth animated gradient background */
        @keyframes gradient-x {

            0%,
            100% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }
        }

        .animate-gradient-x {
            background-size: 200% 200%;
            animation: gradient-x 15s ease infinite;
        }
    </style>

    <%- include('./template/footer.ejs') %>